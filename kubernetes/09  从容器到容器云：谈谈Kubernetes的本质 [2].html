<html>
<head>
  <title>09 | 从容器到容器云：谈谈Kubernetes的本质</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1697"/>
<h1>09 | 从容器到容器云：谈谈Kubernetes的本质</h1>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="color:rgb(51, 51, 51);font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;-ms-text-size-adjust:100%;background:rgb(255, 255, 255);-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div style="font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif;font-size-adjust:none;font-stretch:normal;"><div><div><div><div style="background:rgb(255, 255, 255);padding:30px 0px;flex-flow:row wrap;display:flex;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span><a href="https://time.geekbang.org/" style="color:rgb(229, 124, 57);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);font-size:15px;font-weight:400;">讲堂</a> <span style="font-size:10px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(204, 204, 204);margin-right:5px;"></span></span><span><a href="https://time.geekbang.org/column/116" style="color:rgb(229, 124, 57);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);font-size:15px;font-weight:400;">深入剖析Kubernetes</a> <span style="font-size:10px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(204, 204, 204);margin-right:5px;"></span></span><span><span style="color:rgb(136, 136, 136);font-size:15px;font-weight:400;">文章详情</span> </span></div> <h1 style="margin:0px;padding:0px;color:rgb(53, 53, 53);line-height:1.65rem;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;font-size:1.34rem;font-weight:400;">
        09 | 从容器到容器云：谈谈Kubernetes的本质
      </h1> <div style="color:rgb(136, 136, 136);font-size:0.93rem;margin-top:1.06rem;"><span>2018-09-12</span> <span>张磊</span></div> <div style="color:rgb(53, 53, 53);line-height:1.75rem;font-size:1rem;font-weight:400;white-space:normal;word-break:normal;margin-top:1.06rem;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/babc20175eeaa8e9d33624fadabd011a.jpg" type="image/jpeg" data-filename="babc20175eeaa8e9d33624fadabd011a.jpg" height="390" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/>  <div style="background:rgb(250, 250, 250);margin:1rem 0px;padding:1rem;border:1px solid rgb(217, 217, 217);border-image:none;width:100%;height:5.25rem;display:flex;box-sizing:border-box;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><a href="#" style="color:rgb(26, 188, 156);border-bottom-color:rgb(26, 188, 156);border-bottom-width:1px;border-bottom-style:solid;text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border:medium;border-image:none;flex-shrink:0;background-image:url(data:image/png;base64,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&quot;);background-position:0px 0px;width:2.68rem;height:2.68rem;background-repeat:no-repeat;background-size:contain;"></a> <div style="margin-left:0.68rem;display:flex;min-width:0px;flex-direction:column;flex-grow:1;-webkit-box-flex:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;"><h3 style="margin:0px;padding:0px;color:rgb(53, 53, 53);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;font-size:15.25px;font-weight:500;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;">09 | 从容器到容器云：谈谈Kubernetes的本质</h3> <p style="margin:0.12rem 0px 0px;padding:0px;color:rgb(53, 53, 53);font-weight:400;line-height:1rem;font-size:11px;"><span style="color:rgb(136, 136, 136);">朗读人：张磊   </span> <span style="color:rgb(136, 136, 136);">21′16′′ | 8.53M</span></p></div>  <span style="display:inline-block;width:100%;background-color:rgb(238, 238, 238);" title="09 | 从容器到容器云：谈谈Kubernetes的本质"></span></div> <div><div><p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">你好，我是张磊。今天我和你分享的主题是：从容器到容器云，谈谈 Kubernetes 的本质。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在前面的四篇文章中，我以 Docker 项目为例，一步步剖析了 Linux 容器的具体实现方式。通过这些讲解你应该能够明白：一个“容器”，实际上是一个由 Linux Namespace、Linux Cgroups 和 rootfs 三种技术构建出来的进程的隔离环境。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">从这个结构中我们不难看出，一个正在运行的 Linux 容器，其实可以被“一分为二”地看待：</p>
<ol style="margin:0px;padding:0px;list-style:decimal;margin-bottom:1rem;margin-left:1.9em;">
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">一组联合挂载在 /var/lib/docker/aufs/mnt 上的 rootfs，这一部分我们称为“容器镜像”（Container Image），是容器的静态视图；</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">一个由 Namespace+Cgroups 构成的隔离环境，这一部分我们称为“容器运行时”（Container Runtime），是容器的动态视图。</p>
</li>
</ol>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">更进一步地说，作为一名开发者，我并不关心容器运行时的差异。因为，在整个“开发 - 测试 - 发布”的流程中，真正承载着容器信息进行传递的，是容器镜像，而不是容器运行时。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个重要假设，正是容器技术圈在 Docker 项目成功后不久，就迅速走向了“容器编排”这个“上层建筑”的主要原因：作为一家云服务商或者基础设施提供商，我只要能够将用户提交的 Docker 镜像以容器的方式运行起来，就能成为这个非常热闹的容器生态图上的一个承载点，从而将整个容器技术栈上的价值，沉淀在我的这个节点上。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">更重要的是，只要从我这个承载点向 Docker 镜像制作者和使用者方向回溯，整条路径上的各个服务节点，比如 CI/CD、监控、安全、网络、存储等等，都有我可以发挥和盈利的余地。这个逻辑，正是所有云计算提供商如此热衷于容器技术的重要原因：通过容器镜像，它们可以和潜在用户（即，开发者）直接关联起来。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">从一个开发者和单一的容器镜像，到无数开发者和庞大的容器集群，容器技术实现了从“容器”到“容器云”的飞跃，标志着它真正得到了市场和生态的认可。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这样，<strong style="color:rgb(0, 0, 0);font-weight:500;">容器就从一个开发者手里的小工具，一跃成为了云计算领域的绝对主角；而能够定义容器组织和管理规范的“容器编排”技术，则当仁不让地坐上了容器技术领域的“头把交椅”。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这其中，最具代表性的容器编排工具，当属 Docker 公司的 Compose+Swarm 组合，以及 Google 与 RedHat 公司共同主导的 Kubernetes 项目。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">我在前面介绍容器技术发展历史的四篇预习文章中，已经对这两个开源项目做了详细地剖析和评述。所以，在今天的这次分享中，我会专注于本专栏的主角 Kubernetes 项目，谈一谈它的设计与架构。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">跟很多基础设施领域先有工程实践、后有方法论的发展路线不同，Kubernetes 项目的理论基础则要比工程实践走得靠前得多，这当然要归功于 Google 公司在 2015 年 4 月发布的 Borg 论文了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">Borg 系统，一直以来都被誉为 Google 公司内部最强大的“秘密武器”。虽然略显夸张，但这个说法倒不算是吹牛。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">因为，相比于 Spanner、BigTable 等相对上层的项目，Borg 要承担的责任，是承载 Google 公司整个基础设施的核心依赖。在 Google 公司已经公开发表的基础设施体系论文中，Borg 项目当仁不让地位居整个基础设施技术栈的最底层。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/c7ed0043465bccff2efc1a1257e970bd.png" type="image/png" data-filename="c7ed0043465bccff2efc1a1257e970bd.png" alt="" height="407" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/><br/>
图片来源：<a href="http://malteschwarzkopf.de/research/assets/google-stack.pdf" style="color:rgb(26, 188, 156);border-bottom-color:rgb(26, 188, 156);border-bottom-width:1px;border-bottom-style:solid;text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);">Malte Schwarzkopf. “Operating system support for warehouse-scale computing”. PhD thesis. University of Cambridge Computer Laboratory (to appear), 2015, Chapter 2.</a></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">上面这幅图，来自于 Google Omega 论文的第一作者的博士毕业论文。它描绘了当时 Google 已经公开发表的整个基础设施栈。在这个图里，你既可以找到 MapReduce、BigTable 等知名项目，也能看到 Borg 和它的继任者 Omega 位于整个技术栈的最底层。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">正是由于这样的定位，Borg 可以说是 Google 最不可能开源的一个项目。而幸运地是，得益于 Docker 项目和容器技术的风靡，它却终于得以以另一种方式与开源社区见面，这个方式就是 Kubernetes 项目。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，相比于“小打小闹”的 Docker 公司、“旧瓶装新酒”的 Mesos 社区，<strong style="color:rgb(0, 0, 0);font-weight:500;">Kubernetes 项目从一开始就比较幸运地站上了一个他人难以企及的高度</strong>：在它的成长阶段，这个项目每一个核心特性的提出，几乎都脱胎于 Borg/Omega 系统的设计与经验。更重要的是，这些特性在开源社区落地的过程中，又在整个社区的合力之下得到了极大的改进，修复了很多当年遗留在 Borg 体系中的缺陷和问题。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，尽管在发布之初被批评是“曲高和寡”，但是在逐渐觉察到 Docker 技术栈的“稚嫩”和 Mesos 社区的“老迈”之后，这个社区很快就明白了：Kubernetes 项目在 Borg 体系的指导下，体现出了一种独有的“先进性”与“完备性”，而这些特质才是一个基础设施领域开源项目赖以生存的核心价值。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">为了更好地理解这两种特质，我们不妨从 Kubernetes 的顶层设计说起。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><span style="color:rgb(255, 90, 5);">首先，Kubernetes 项目要解决的问题是什么？</span></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">编排？调度？容器云？还是集群管理？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">实际上，这个问题到目前为止都没有固定的答案。因为在不同的发展阶段，Kubernetes 需要着重解决的问题是不同的。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">但是，对于大多数用户来说，他们希望 Kubernetes 项目带来的体验是确定的：现在我有了应用的容器镜像，请帮我在一个给定的集群上把这个应用运行起来。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">更进一步地说，我还希望 Kubernetes 能给我提供路由网关、水平扩展、监控、备份、灾难恢复等一系列运维能力。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">等一下，这些功能听起来好像有些耳熟？这不就是经典 PaaS（比如，Cloud Foundry）项目的能力吗？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而且，有了 Docker 之后，我根本不需要什么 Kubernetes、PaaS，只要使用 Docker 公司的 Compose+Swarm 项目，就完全可以很方便地 DIY 出这些功能了！</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以说，如果 Kubernetes 项目只是停留在拉取用户镜像、运行容器，以及提供常见的运维功能的话，那么别说跟“原生”的 Docker Swarm 项目竞争了，哪怕跟经典的 PaaS 项目相比也难有什么优势可言。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而实际上，在定义核心功能的过程中，Kubernetes 项目正是依托着 Borg 项目的理论优势，才在短短几个月内迅速站稳了脚跟，进而确定了一个如下图所示的全局架构：</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/8ee9f2fa987eccb490cfaa91c6484f67.png" type="image/png" data-filename="8ee9f2fa987eccb490cfaa91c6484f67.png" alt="" height="392" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">我们可以看到，Kubernetes 项目的架构，跟它的原型项目 Borg 非常类似，都由 Master 和 Node 两种节点组成，而这两种角色分别对应着控制节点和计算节点。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">其中，控制节点，即 Master 节点，由三个紧密协作的独立组件组合而成，它们分别是负责 API 服务的 kube-apiserver、负责调度的 kube-scheduler，以及负责容器编排的 kube-controller-manager。整个集群的持久化数据，则由 kube-apiserver 处理后保存在 Ectd 中。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而计算节点上最核心的部分，则是一个叫作 kubelet 的组件。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">在 Kubernetes 项目中，kubelet 主要负责同容器运行时（比如 Docker 项目）打交道</strong>。而这个交互所依赖的，是一个称作 CRI（Container Runtime Interface）的远程调用接口，这个接口定义了容器运行时的各项核心操作，比如：启动一个容器需要的所有参数。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这也是为何，Kubernetes 项目并不关心你部署的是什么容器运行时、使用的什么技术实现，只要你的这个容器运行时能够运行标准的容器镜像，它就可以通过实现 CRI 接入到 Kubernetes 项目当中。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而具体的容器运行时，比如 Docker 项目，则一般通过 OCI 这个容器运行时规范同底层的 Linux 操作系统进行交互，即：把 CRI 请求翻译成对 Linux 操作系统的调用（操作 Linux Namespace 和 Cgroups 等）。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">此外，kubelet 还通过 gRPC 协议同一个叫作 Device Plugin 的插件进行交互</strong>。这个插件，是 Kubernetes 项目用来管理 GPU 等宿主机物理设备的主要组件，也是基于 Kubernetes 项目进行机器学习训练、高性能作业支持等工作必须关注的功能。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而<strong style="color:rgb(0, 0, 0);font-weight:500;">kubelet 的另一个重要功能，则是调用网络插件和存储插件为容器配置网络和持久化存储</strong>。这两个插件与 kubelet 进行交互的接口，分别是 CNI（Container Networking Interface）和 CSI（Container Storage Interface）。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">实际上，kubelet 这个奇怪的名字，来自于 Borg 项目里的同源组件 Borglet。不过，如果你浏览过 Borg 论文的话，就会发现，这个命名方式可能是 kubelet 组件与 Borglet 组件的唯一相似之处。因为 Borg 项目，并不支持我们这里所讲的容器技术，而只是简单地使用了 Linux Cgroups 对进程进行限制。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这就意味着，像 Docker 这样的“容器镜像”在 Borg 中是不存在的，Borglet 组件也自然不需要像 kubelet 这样考虑如何同 Docker 进行交互、如何对容器镜像进行管理的问题，也不需要支持 CRI、CNI、CSI 等诸多容器技术接口。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">可以说，kubelet 完全就是为了实现 Kubernetes 项目对容器的管理能力而重新实现的一个组件，与 Borg 之间并没有直接的传承关系。</p>
<blockquote style="margin:1em 3em 1em 2em;padding:0px;color:rgb(153, 153, 153);padding-left:1em;font-weight:400;border-left-color:rgb(26, 188, 156);border-left-width:1px;border-left-style:solid;position:relative;margin-bottom:1rem;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">备注：虽然不使用 Docker，但 Google 内部确实在使用一个包管理工具，名叫 Midas Package Manager (MPM)，其实它可以部分取代 Docker 镜像的角色。</p>
</blockquote>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><span style="color:rgb(255, 90, 5);">那么，Borg 对于 Kubernetes 项目的指导作用又体现在哪里呢？</span></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">答案是，Master 节点。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">虽然在 Master 节点的实现细节上 Borg 项目与 Kubernetes 项目不尽相同，但它们的出发点却高度一致，即：如何编排、管理、调度用户提交的作业？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，Borg 项目完全可以把 Docker 镜像看做是一种新的应用打包方式。这样，Borg 团队过去在大规模作业管理与编排上的经验就可以直接“套”在 Kubernetes 项目上了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这些经验最主要的表现就是，<strong style="color:rgb(0, 0, 0);font-weight:500;">从一开始，Kubernetes 项目就没有像同时期的各种“容器云”项目那样，把 Docker 作为整个架构的核心，而仅仅把它作为最底层的一个容器运行时实现。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而 Kubernetes 项目要着重解决的问题，则来自于 Borg 的研究人员在论文中提到的一个非常重要的观点：</p>
<blockquote style="margin:1em 3em 1em 2em;padding:0px;color:rgb(153, 153, 153);padding-left:1em;font-weight:400;border-left-color:rgb(26, 188, 156);border-left-width:1px;border-left-style:solid;position:relative;margin-bottom:1rem;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">运行在大规模集群中的各种任务之间，实际上存在着各种各样的关系。这些关系的处理，才是作业编排和管理系统最困难的地方。</p>
</blockquote>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">事实也正是如此。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">其实，这种任务与任务之间的关系，在我们平常的各种技术场景中随处可见。比如，一个 Web 应用与数据库之间的访问关系，一个负载均衡器和它的后端服务之间的代理关系，一个门户应用与授权组件之间的调用关系。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">更进一步地说，同属于一个服务单位的不同功能之间，也完全可能存在这样的关系。比如，一个 Web 应用与日志搜集组件之间的文件交换关系。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而在容器技术普及之前，传统虚拟机环境对这种关系的处理方法都是比较“粗粒度”的。你会经常发现很多功能并不相关的应用被一股脑儿地部署在同一台虚拟机中，只是因为它们之间偶尔会互相发起几个 HTTP 请求。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">更常见的情况则是，一个应用被部署在虚拟机里之后，你还得手动维护很多跟它协作的守护进程（Daemon），用来处理它的日志搜集、灾难恢复、数据备份等辅助工作。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">但容器技术出现以后，你就不难发现，在“功能单位”的划分上，容器有着独一无二的“细粒度”优势：毕竟容器的本质，只是一个进程而已。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">也就是说，只要你愿意，那些原先拥挤在同一个虚拟机里的各个应用、组件、守护进程，都可以被分别做成镜像，然后运行在一个个专属的容器中。它们之间互不干涉，拥有各自的资源配额，可以被调度在整个集群里的任何一台机器上。而这，正是一个 PaaS 系统最理想的工作状态，也是所谓“微服务”思想得以落地的先决条件。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">当然，如果只做到“封装微服务、调度单容器”这一层次，Docker Swarm 项目就已经绰绰有余了。如果再加上 Compose 项目，你甚至还具备了处理一些简单依赖关系的能力，比如：一个“Web 容器”和它要访问的数据库“DB 容器”。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在 Compose 项目中，你可以为这样的两个容器定义一个“link”，而 Docker 项目则会负责维护这个“link”关系，其具体做法是：Docker 会在 Web 容器中，将 DB 容器的 IP 地址、端口等信息以环境变量的方式注入进去，供应用进程使用，比如：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    DB_NAME=/web/db</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    DB_PORT=tcp://172.17.0.5:5432</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">3</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    DB_PORT_5432_TCP=tcp://172.17.0.5:5432</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">4</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    DB_PORT_5432_TCP_PROTO=tcp</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">5</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    DB_PORT_5432_TCP_PORT=5432</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">6</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    DB_PORT_5432_TCP_ADDR=172.17.0.5</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而当 DB 容器发生变化时（比如，镜像更新，被迁移到其他宿主机上等等），这些环境变量的值会由 Docker 项目自动更新。<strong style="color:rgb(0, 0, 0);font-weight:500;">这就是平台项目自动地处理容器间关系的典型例子。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">可是，如果我们现在的需求是，要求这个项目能够处理前面提到的所有类型的关系，甚至还要能够支持未来可能出现的更多种类的关系呢？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这时，“link”这种单独针对一种案例设计的解决方案就太过简单了。如果你做过架构方面的工作，就会深有感触：一旦要追求项目的普适性，那就一定要从顶层开始做好设计。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，<strong style="color:rgb(0, 0, 0);font-weight:500;">Kubernetes 项目最主要的设计思想是，从更宏观的角度，以统一的方式来定义任务之间的各种关系，并且为将来支持更多种类的关系留有余地。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">比如，Kubernetes 项目对容器间的“访问”进行了分类，首先总结出了一类非常常见的“紧密交互”的关系，即：这些应用之间需要非常频繁的交互和访问；又或者，它们会直接通过本地文件进行信息交换。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在常规环境下，这些应用往往会被直接部署在同一台机器上，通过 Localhost 通信，通过本地磁盘目录交换文件。而在 Kubernetes 项目中，这些容器则会被划分为一个“Pod”，Pod 里的容器共享同一个 Network Namespace、同一组数据卷，从而达到高效率交换信息的目的。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">Pod 是 Kubernetes 项目中最基础的一个对象，源自于 Google Borg 论文中一个名叫 Alloc 的设计。在后续的章节中，我们会对 Pod 做更进一步地阐述。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而对于另外一种更为常见的需求，比如 Web 应用与数据库之间的访问关系，Kubernetes 项目则提供了一种叫作“Service”的服务。像这样的两个应用，往往故意不部署在同一台机器上，这样即使 Web 应用所在的机器宕机了，数据库也完全不受影响。可是，我们知道，对于一个容器来说，它的 IP 地址等信息不是固定的，那么 Web 应用又怎么找到数据库容器的 Pod 呢？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，Kubernetes 项目的做法是给 Pod 绑定一个 Service 服务，而 Service 服务声明的 IP 地址等信息是“终生不变”的。这个<strong style="color:rgb(0, 0, 0);font-weight:500;">Service 服务的主要作用，就是作为 Pod 的代理入口（Portal），从而代替 Pod 对外暴露一个固定的网络地址</strong>。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这样，对于 Web 应用的 Pod 来说，它需要关心的就是数据库 Pod 的 Service 信息。不难想象，Service 后端真正代理的 Pod 的 IP 地址、端口等信息的自动更新、维护，则是 Kubernetes 项目的职责。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">像这样，围绕着容器和 Pod 不断向真实的技术场景扩展，我们就能够摸索出一幅如下所示的 Kubernetes 项目核心功能的“全景图”。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/16c095d6efb8d8c226ad9b098689f306.png" type="image/png" data-filename="16c095d6efb8d8c226ad9b098689f306.png" alt="" height="392" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">按照这幅图的线索，我们从容器这个最基础的概念出发，首先遇到了容器间“紧密协作”关系的难题，于是就扩展到了 Pod；有了 Pod 之后，我们希望能一次启动多个应用的实例，这样就需要 Deployment 这个 Pod 的多实例管理器；而有了这样一组相同的 Pod 后，我们又需要通过一个固定的 IP 地址和端口以负载均衡的方式访问它，于是就有了 Service。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">可是，如果现在两个不同 Pod 之间不仅有“访问关系”，还要求在发起时加上授权信息。最典型的例子就是 Web 应用对数据库访问时需要 Credential（数据库的用户名和密码）信息。那么，在 Kubernetes 中这样的关系又如何处理呢？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">Kubernetes 项目提供了一种叫作 Secret 的对象，它其实是一个保存在 Etcd 里的键值对数据。这样，你把 Credential 信息以 Secret 的方式存在 Etcd 里，Kubernetes 就会在你指定的 Pod（比如，Web 应用的 Pod）启动时，自动把 Secret 里的数据以 Volume 的方式挂载到容器里。这样，这个 Web 应用就可以访问数据库了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">除了应用与应用之间的关系外，应用运行的形态是影响“如何容器化这个应用”的第二个重要因素。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">为此，Kubernetes 定义了新的、基于 Pod 改进后的对象。比如 Job，用来描述一次性运行的 Pod（比如，大数据任务）；再比如 DaemonSet，用来描述每个宿主机上必须且只能运行一个副本的守护进程服务；又比如 CronJob，则用于描述定时任务等等。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">如此种种，正是 Kubernetes 项目定义容器间关系和形态的主要方法。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">可以看到，Kubernetes 项目并没有像其他项目那样，为每一个管理功能创建一个指令，然后在项目中实现其中的逻辑。这种做法，的确可以解决当前的问题，但是在更多的问题来临之后，往往会力不从心。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">相比之下，在 Kubernetes 项目中，我们所推崇的使用方法是：</p>
<ul style="margin:0px;padding:0px;list-style:disc;margin-bottom:1rem;margin-left:1.3em;">
<li style="margin:0px;padding:0px;">首先，通过一个“编排对象”，比如 Pod、Job、CronJob 等，来描述你试图管理的应用；</li>
<li style="margin:0px;padding:0px;">然后，再为它定义一些“服务对象”，比如 Service、Secret、Horizontal Pod Autoscaler（自动水平扩展器）等。这些对象，会负责具体的平台级功能。</li>
</ul>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">这种使用方法，就是所谓的“声明式 API”。这种 API 对应的“编排对象”和“服务对象”，都是 Kubernetes 项目中的 API 对象（API Object）。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这就是 Kubernetes 最核心的设计理念，也是接下来我会重点剖析的关键技术点。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><span style="color:rgb(255, 90, 5);">最后，我来回答一个更直接的问题：Kubernetes 项目如何启动一个容器化任务呢？</span></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">比如，我现在已经制作好了一个 Nginx 容器镜像，希望让平台帮我启动这个镜像。并且，我要求平台帮我运行两个完全相同的 Nginx 副本，以负载均衡的方式共同对外提供服务。</p>
<ul style="margin:0px;padding:0px;list-style:disc;margin-bottom:1rem;margin-left:1.3em;">
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">如果是自己 DIY 的话，可能需要启动两台虚拟机，分别安装两个 Nginx，然后使用 keepalived 为这两个虚拟机做一个虚拟 IP。</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而如果使用 Kubernetes 项目呢？你需要做的则是编写如下这样一个 YAML 文件（比如名叫 nginx-deployment.yaml）：</p>
</li>
</ul>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>apiVersion: apps/v1</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>kind: Deployment</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">3</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>metadata:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">4</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  name: nginx-deployment</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">5</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  labels:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">6</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    app: nginx</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">7</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>spec:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">8</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  replicas: 2</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">9</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  selector:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">10</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    matchLabels:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">11</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      app: nginx</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">12</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  template:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">13</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    metadata:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">14</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      labels:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">15</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>        app: nginx</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">16</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    spec:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">17</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      containers:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">18</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      - name: nginx</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">19</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>        image: nginx:1.7.9</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">20</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>        ports:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">21</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>        - containerPort: 80</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在上面这个 YAML 文件中，我们定义了一个 Deployment 对象，它的主体部分（spec.template 部分）是一个使用 Nginx 镜像的 Pod，而这个 Pod 的副本数是 2（replicas=2）。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">然后执行：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>$ kubectl create -f nginx-deployment.yaml</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这样，两个完全相同的 Nginx 容器副本就被启动了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">不过，这么看来，做同样一件事情，Kubernetes 用户要做的工作也不少嘛。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">别急，在后续的讲解中，我会陆续介绍 Kubernetes 项目这种“声明式 API”的种种好处，以及基于它实现的强大的编排能力。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">拭目以待吧。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">总结</h2>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">首先，我和你一起回顾了容器的核心知识，说明了容器其实可以分为两个部分：容器运行时和容器镜像。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">然后，我重点介绍了 Kubernetes 项目的架构，详细讲解了它如何使用“声明式 API”来描述容器化业务和容器间关系的设计思想。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">实际上，过去很多的集群管理项目（比如 Yarn、Mesos，以及 Swarm）所擅长的，都是把一个容器，按照某种规则，放置在某个最佳节点上运行起来。这种功能，我们称为“调度”。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而 Kubernetes 项目所擅长的，是按照用户的意愿和整个系统的规则，完全自动化地处理好容器之间的各种关系。<strong style="color:rgb(0, 0, 0);font-weight:500;">这种功能，就是我们经常听到的一个概念：编排。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以说，Kubernetes 项目的本质，是为用户提供一个具有普遍意义的容器编排工具。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">不过，更重要的是，Kubernetes 项目为用户提供的不仅限于一个工具。它真正的价值，乃在于提供了一套基于容器构建分布式系统的基础依赖。关于这一点，相信你会在今后的学习中，体会的越来越深。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">思考题</h2>
<ol style="margin:0px;padding:0px;list-style:decimal;margin-bottom:1rem;margin-left:1.9em;">
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这今天的分享中，我介绍了 Kubernetes 项目的架构。你是否了解了 Docker Swarm（SwarmKit 项目）跟 Kubernetes 在架构上和使用方法上的异同呢？</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在 Kubernetes 之前，很多项目都没办法管理“有状态”的容器，即，不能从一台宿主机“迁移”到另一台宿主机上的容器。你是否能列举出，阻止这种“迁移”的原因都有哪些呢？</p>
</li>
</ol>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">感谢你的收听，欢迎你给我留言，也欢迎分享给更多的朋友一起阅读。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/47a6f3bf6b92d58512d5a2ed0a556f55.jpg" type="image/jpeg" data-filename="47a6f3bf6b92d58512d5a2ed0a556f55.jpg" alt="" height="344" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/></p>
</div></div> <p style="margin:0px;padding:0px;margin-bottom:30px;color:rgb(153, 153, 153);font-weight:400;margin-top:0.15rem;">
          版权归极客邦科技所有，未经许可不得转载
        </p></div> <div style="overflow:hidden;margin-bottom:-30px;"><a style="color:rgb(255, 255, 255);text-decoration:none;height:20px;text-align:center;line-height:20px;font-size:12px;display:inline-block;flex-grow:1;border-radius:3px;background-color:rgb(255, 90, 5);word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-box-flex:1;padding:4px 8px;cursor:pointer;float:right;">写留言</a></div> <div style="margin-top:2rem;"><h2 style="margin:0px;padding:0px;color:rgb(136, 136, 136);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;text-align:center;margin-bottom:1rem;position:relative;z-index:1;"><span style="color:rgb(136, 136, 136);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;text-align:center;left:0px;top:56%;width:100%;border-top-color:rgb(136, 136, 136);border-top-width:1px;border-top-style:dotted;position:absolute;z-index:-1;"></span><span style="background:rgb(255, 255, 255);padding:0px 1rem;font-size:15.25px;font-weight:400;display:inline-block;">精选留言</span></h2> <ul style="margin:0px;padding:0px;list-style:none;"><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/defaultAvatar.e4ab9fe.jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Geek_zz</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">46</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">对这个专栏看的越多，越觉得作者讲得有条理又有深度，物超超超所值</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/54cad83b.jpg" type="image/jpeg" data-filename="54cad83b.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">hugeo</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">18</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">学费太值得了，老师太会教课了说得很清楚</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/132.jpg" type="image/jpeg" data-filename="132.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Jeff.W</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">15</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">从微服务架构来讲，多个独立功能内聚的服务带来了整体的灵活性，但是同时也带来了部署运维的复杂度提升，这时Docker配合Devops带来了不少的便利(轻量、隔离、一致性、CI、CD等)解决了不少问题，再配合compose，看起来一切都很美了，为什么还需要K8s？可以试着这样理解么？把微服务理解为人，那么服务治理其实就是人之间的沟通而已，人太多了就需要生存空间和沟通方式的优化，这就需要集群和编排了。Docker Compose，swarm，可以解决少数人之间的关系，比如把手机号给你，你就可以方便的找到我，但是如果手机号变更的时候就会麻烦，人多了也会麻烦。而k8s是站在上帝视角俯视芸芸众生后的高度抽象，他看到了大概有哪些类人(组织）以及不同组织有什么样的特点（Job、CornJob、Autoscaler、StatefulSet、DaemonSet...），不同组织之间交流可能需要什么（ConfigMap,Secret...）,这样比价紧密的人们在相同pod中，通过Service-不会变更的手机号，来和不同的组织进行沟通，Deployment、RC则可以帮组人们快速构建组织。Dokcer 后出的swarm mode，有类似的视角抽象（比如Service），不过相对来说并不完善。以上，是否可以这样理解？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-16</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">没毛病</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-16</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/defaultAvatar.e4ab9fe [1].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Xiye</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">对于第二个问题，是不是像存储在文件或者数据库里的数据还是比较好迁移，但是对于缓存，临时存储的数据是不是就不太好迁移。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">没错！</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-13</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/534db55d.jpg" type="image/jpeg" data-filename="534db55d.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">huan</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">1 我自己用swarm后，感觉和docker 公司的整体风格很一致：上手简单，但是最后还是没用的很好，因为毕竟需要太多的依赖需要在不同容器之间传递。k8s从更高视野看服务器软件架构从而提出更有效而且看起来更重的方案，最终被证明是有效的。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/474d5eaf.jpg" type="image/jpeg" data-filename="474d5eaf.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Tigerfive</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">感觉不能迁移“有状态”的容器，是因为迁移的是容器的rootfs，但是一些动态视图是没有办法伴随迁移一同进行迁移的。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">是的，到目前为止，迁移都是做不到的，只能删除后在新的节点上重新创建</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-12</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/defaultAvatar.e4ab9fe [2].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">pytimer</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">3</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">第二个问题: 我觉得应该是很多容器数据都是挂载在本地路径，所以没办法直接进行迁移。<br/><br/>如果容器的数据挂载在共享存储上，那是不是没有kubernetes也是可以迁移有状态的容器？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">那就要看有多少种状态需要处理啦</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-12</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/132 [1].jpg" type="image/jpeg" data-filename="132.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Scott</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">为什么一个node上，kubelet与Device plugin要走gRPC，这个没有CSI这样的专门中间层吗？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-16</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">没有，这一块的设计我后面会讲到</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-17</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/132 [2].jpg" type="image/jpeg" data-filename="132.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">骨汤鸡蛋面</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">一直对CNI、CSI 有点困惑，为什么不将其纳入到container runtime/oci 的范畴？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-13</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">前面是paas层用的，后面是容器用的</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-13</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/defaultAvatar.e4ab9fe [3].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">sprzhing</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">不能迁移是因为容器在本地的很多状态修改不会commit到云端吧？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/4aed8129.jpg" type="image/jpeg" data-filename="4aed8129.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">LiJiao</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">迁移可以简单分为两类：磁盘数据文件不变，进程重启；磁盘数据文件不变、内存数据也不变，相当于连带进程一起挪过去。第一种类型有很简单的方法：挂载云盘，从空间上解耦。第二种类型就复杂了，需要将内存数据一点点迁移过去，最后瞬间切换。IaaS很早就应用热迁移技术了。<br/><br/>Kubernetes则讨巧了，只着眼于应用，直接约定容器是可以随时被杀死的，热迁移就没有那么重要了。甚至连IP都隐藏了，又绕过了一个大难题～</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-21</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/a6db1c1e.jpg" type="image/jpeg" data-filename="a6db1c1e.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">silver</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">为什么说mesos是老迈和旧瓶装新酒呢？Mesos本身所做的事情是有限的，很大一部分取决于它的scheduler,谈论mesos不是很大一方面取决于scheduler么</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-17</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">mesos是旧瓶，marathon是新酒</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-17</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/3e4607c7.jpg" type="image/jpeg" data-filename="3e4607c7.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Gao</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">面向yaml文件编程</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-16</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/22eae851.jpg" type="image/jpeg" data-filename="22eae851.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Rod</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">@老师。我记得service的ip也是可变的。不变的是service name。通过kube dns解析。当然service可以绑定主机名。但是那样就不能高可用。不知道我说的对不对？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-13</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">service vip不会变，除非你把它删了重建。通过dns解析的是headless service，它不会分配vip。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-13</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/145c10db.jpg" type="image/jpeg" data-filename="145c10db.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">每日都想上班</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">我们单位正在使用k8s，很棒的课程，听了后理解更加深入</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-13</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/9b248708.jpg" type="image/jpeg" data-filename="9b248708.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">阿硕</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">整个集群的持久化数据，则由 kube-apiserver 处理后保存在 Ectd 中。是不是Etcd呢？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">对对</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-13</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/defaultAvatar.e4ab9fe [4].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">天下</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">没法迁移是不能方便解决相互之间的依赖，耦合度高的，随着项目的变大各种依赖会让人崩溃。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-12</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/7266ee09.jpg" type="image/jpeg" data-filename="7266ee09.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">哈</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">0</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">讲的太好了，本是抱着了解的态度，没想到讲的十分细致生动，让我都想转为运维了。真的越看越有意思！！！！！！！</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-10-07</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">ops和开发不分家</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-10-08</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/fc80bc6d.jpg" type="image/jpeg" data-filename="fc80bc6d.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">大豪。</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">0</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">这价格讲到这种程度，跟捡到便宜似的，感谢作者</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-29</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="09  从容器到容器云：谈谈Kubernetes的本质 [2]_files/132 [3].jpg" type="image/jpeg" data-filename="132.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">天勤</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">0</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">讲的很透彻，物超所值！</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-26</span> </div></li></ul></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 