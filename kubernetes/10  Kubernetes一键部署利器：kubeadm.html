<html>
<head>
  <title>10 | Kubernetes一键部署利器：kubeadm</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1513"/>
<h1>10 | Kubernetes一键部署利器：kubeadm</h1>

<div><span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="color:rgb(51, 51, 51);font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;-ms-text-size-adjust:100%;background:rgb(255, 255, 255);-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div style="font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif;font-size-adjust:none;font-stretch:normal;"><div><div><div><div style="background:rgb(255, 255, 255);padding:30px 0px;flex-flow:row wrap;display:flex;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span><a href="https://time.geekbang.org/" style="color:rgb(229, 124, 57);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);font-size:15px;font-weight:400;">讲堂</a> <span style="font-size:10px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(204, 204, 204);margin-right:5px;"></span></span><span><a href="https://time.geekbang.org/column/116" style="color:rgb(229, 124, 57);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);font-size:15px;font-weight:400;">深入剖析Kubernetes</a> <span style="font-size:10px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(204, 204, 204);margin-right:5px;"></span></span><span><span style="color:rgb(136, 136, 136);font-size:15px;font-weight:400;">文章详情</span> </span></div> <h1 style="margin:0px;padding:0px;color:rgb(53, 53, 53);line-height:1.65rem;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;font-size:1.34rem;font-weight:400;">
        10 | Kubernetes一键部署利器：kubeadm
      </h1> <div style="color:rgb(136, 136, 136);font-size:0.93rem;margin-top:1.06rem;"><span>2018-09-14</span> <span>张磊</span></div> <div style="color:rgb(53, 53, 53);line-height:1.75rem;font-size:1rem;font-weight:400;white-space:normal;word-break:normal;margin-top:1.06rem;"><img src="10  Kubernetes一键部署利器：kubeadm_files/d0ee4192eae07716a186281397b1cf1a.jpg" type="image/jpeg" data-filename="d0ee4192eae07716a186281397b1cf1a.jpg" height="390" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/>  <div style="background:rgb(250, 250, 250);margin:1rem 0px;padding:1rem;border:1px solid rgb(217, 217, 217);border-image:none;width:100%;height:5.25rem;display:flex;box-sizing:border-box;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><a href="#" style="color:rgb(26, 188, 156);border-bottom-color:rgb(26, 188, 156);border-bottom-width:1px;border-bottom-style:solid;text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border:medium;border-image:none;flex-shrink:0;background-image:url(data:image/png;base64,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&quot;);background-position:0px 0px;width:2.68rem;height:2.68rem;background-repeat:no-repeat;background-size:contain;"></a> <div style="margin-left:0.68rem;display:flex;min-width:0px;flex-direction:column;flex-grow:1;-webkit-box-flex:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;"><h3 style="margin:0px;padding:0px;color:rgb(53, 53, 53);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;font-size:15.25px;font-weight:500;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;">10 | Kubernetes一键部署利器：kubeadm</h3> <p style="margin:0.12rem 0px 0px;padding:0px;color:rgb(53, 53, 53);font-weight:400;line-height:1rem;font-size:11px;"><span style="color:rgb(136, 136, 136);">朗读人：张磊   </span> <span style="color:rgb(136, 136, 136);">17′20′′ | 7.95M</span></p></div>  <span style="display:inline-block;width:100%;background-color:rgb(238, 238, 238);" title="10 | Kubernetes一键部署利器：kubeadm"></span></div> <div><div><p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">你好，我是张磊。今天我和你分享的主题是：Kubernetes 一键部署利器之 kubeadm。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">通过前面几篇文章的内容，我其实阐述了这样一个思想：<strong style="color:rgb(0, 0, 0);font-weight:500;">要真正发挥容器技术的实力，你就不能仅仅局限于对 Linux 容器本身的钻研和使用。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这些知识更适合作为你的技术储备，以便在需要的时候可以帮你更快的定位问题，并解决问题。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而更深入的学习容器技术的关键在于，<strong style="color:rgb(0, 0, 0);font-weight:500;">如何使用这些技术来“容器化”你的应用。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">比如，我们的应用既可能是 Java Web 和 MySQL 这样的组合，也可能是 Cassandra 这样的分布式系统。而要使用容器把后者运行起来，你单单通过 Docker 把一个 Cassandra 镜像跑起来是没用的。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">要把 Cassandra 应用容器化的关键，在于如何处理好这些 Cassandra 容器之间的编排关系。比如，哪些 Cassandra 容器是主，哪些是从？主从容器如何区分？它们之间又如何进行自动发现和通信？Cassandra 容器的持久化数据又如何保持，等等。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这也是为什么我们要反复强调 Kubernetes 项目的主要原因：这个项目体现出来的容器化“表达能力”，具有独有的先进性和完备性。这就使得它不仅能运行 Java Web 与 MySQL 这样的常规组合，还能够处理 Cassandra 容器集群等复杂编排问题。所以，对这种编排能力的剖析、解读和最佳实践，将是本专栏最重要的一部分内容。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">不过，万事开头难。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">作为一个典型的分布式项目，Kubernetes 的部署一直以来都是挡在初学者前面的一只“拦路虎”。尤其是在 Kubernetes 项目发布初期，它的部署完全要依靠一堆由社区维护的脚本。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">其实，Kubernetes 作为一个 Golang 项目，已经免去了很多类似于 Python 项目要安装语言级别依赖的麻烦。但是，除了将各个组件编译成二进制文件外，用户还要负责为这些二进制文件编写对应的配置文件、配置自启动脚本，以及为 kube-apiserver 配置授权文件等等诸多运维工作。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">目前，各大云厂商最常用的部署的方法，是使用 SaltStack、Ansible 等运维工具自动化地执行这些步骤。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">但即使这样，这个部署过程依然非常繁琐。因为，SaltStack 这类专业运维工具本身的学习成本，就可能比 Kubernetes 项目还要高。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">难道 Kubernetes 项目就没有简单的部署方法了吗？</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个问题，在 Kubernetes 社区里一直没有得到足够重视。直到 2017 年，在志愿者的推动下，社区才终于发起了一个独立的部署工具，名叫：<a href="https://github.com/kubernetes/kubeadm" style="color:rgb(26, 188, 156);border-bottom-color:rgb(26, 188, 156);border-bottom-width:1px;border-bottom-style:solid;text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);">kubeadm</a>。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个项目的目的，就是要让用户能够通过这样两条指令完成一个 Kubernetes 集群的部署：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div># 创建一个 Master 节点</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>$ kubeadm init</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">3</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div> </div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">4</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div># 将一个 Node 节点加入到当前集群中</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">5</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>$ kubeadm join &lt;Master 节点的 IP 和端口 &gt;</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">是不是非常方便呢？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">不过，你可能也会有所顾虑：<strong style="color:rgb(0, 0, 0);font-weight:500;">Kubernetes 的功能那么多，这样一键部署出来的集群，能用于生产环境吗？</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">为了回答这个问题，在今天这篇文章，我就先和你介绍一下 kubeadm 的工作原理吧。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">kubeadm 的工作原理</h2>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在上一篇文章《从容器到容器云：谈谈 Kubernetes 的本质》中，我已经详细介绍了 Kubernetes 的架构和它的组件。在部署时，它的每一个组件都是一个需要被执行的、单独的二进制文件。所以不难想象，SaltStack 这样的运维工具或者由社区维护的脚本的功能，就是要把这些二进制文件传输到指定的机器当中，然后编写控制脚本来启停这些组件。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">不过，在理解了容器技术之后，你可能已经萌生出了这样一个想法，<strong style="color:rgb(0, 0, 0);font-weight:500;">为什么不用容器部署 Kubernetes 呢？</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这样，我只要给每个 Kubernetes 组件做一个容器镜像，然后在每台宿主机上用 docker run 指令启动这些组件容器，部署不就完成了吗？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">事实上，在 Kubernetes 早期的部署脚本里，确实有一个脚本就是用 Docker 部署 Kubernetes 项目的，这个脚本相比于 SaltStack 等的部署方式，也的确简单了不少。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">但是，<strong style="color:rgb(0, 0, 0);font-weight:500;">这样做会带来一个很麻烦的问题，即：如何容器化 kubelet。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">我在上一篇文章中，已经提到 kubelet 是 Kubernetes 项目用来操作 Docker 等容器运行时的核心组件。可是，除了跟容器运行时打交道外，kubelet 在配置容器网络、管理容器数据卷时，都需要直接操作宿主机。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而如果现在 kubelet 本身就运行在一个容器里，那么直接操作宿主机就会变得很麻烦。对于网络配置来说还好，kubelet 容器可以通过不开启 Network Namespace（即 Docker 的 host network 模式）的方式，直接共享宿主机的网络栈。可是，要让 kubelet 隔着容器的 Mount Namespace 和文件系统，操作宿主机的文件系统，就有点儿困难了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">比如，如果用户想要使用 NFS 做容器的持久化数据卷，那么 kubelet 就需要在容器进行绑定挂载前，在宿主机的指定目录上，先挂载 NFS 的远程目录。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">可是，这时候问题来了。由于现在 kubelet 是运行在容器里的，这就意味着它要做的这个“mount -F nfs”命令，被隔离在了一个单独的 Mount Namespace 中。即，kubelet 做的挂载操作，不能被“传播”到宿主机上。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">对于这个问题，有人说，可以使用 setns() 系统调用，在宿主机的 Mount Namespace 中执行这些挂载操作；也有人说，应该让 Docker 支持一个–mnt=host 的参数。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">但是，到目前为止，在容器里运行 kubelet，依然没有很好的解决办法，我也不推荐你用容器去部署 Kubernetes 项目。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">正因为如此，kubeadm 选择了一种妥协方案：</p>
<blockquote style="margin:1em 3em 1em 2em;padding:0px;color:rgb(153, 153, 153);padding-left:1em;font-weight:400;border-left-color:rgb(26, 188, 156);border-left-width:1px;border-left-style:solid;position:relative;margin-bottom:1rem;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">把 kubelet 直接运行在宿主机上，然后使用容器部署其他的 Kubernetes 组件。</p>
</blockquote>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，你使用 kubeadm 的第一步，是在机器上手动安装 kubeadm、kubelet 和 kubectl 这三个二进制文件。当然，kubeadm 的作者已经为各个发行版的 Linux 准备好了安装包，所以你只需要执行：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>$ apt-get install kubeadm</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">就可以了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">接下来，你就可以使用“kubeadm init”部署 Master 节点了。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">kubeadm init 的工作流程</h2>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">当你执行 kubeadm init 指令后，<strong style="color:rgb(0, 0, 0);font-weight:500;">kubeadm 首先要做的，是一系列的检查工作，以确定这台机器可以用来部署 Kubernetes</strong>。这一步检查，我们称为“Preflight Checks”，它可以为你省掉很多后续的麻烦。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">其实，Preflight Checks 包括了很多方面，比如：</p>
<ul style="margin:0px;padding:0px;list-style:disc;margin-bottom:1rem;margin-left:1.3em;">
<li style="margin:0px;padding:0px;">Linux 内核的版本必须是否是 3.10 以上？</li>
<li style="margin:0px;padding:0px;">Linux Cgroups 模块是否可用？</li>
<li style="margin:0px;padding:0px;">机器的 hostname 是否标准？在 Kubernetes 项目里，机器的名字以及一切存储在 Etcd 中的 API 对象，都必须使用标准的 DNS 命名（RFC 1123）。</li>
<li style="margin:0px;padding:0px;">用户安装的 kubeadm 和 kubelet 的版本是否匹配？</li>
<li style="margin:0px;padding:0px;">机器上是不是已经安装了 Kubernetes 的二进制文件？</li>
<li style="margin:0px;padding:0px;">Kubernetes 的工作端口 10250/10251/10252 端口是不是已经被占用？</li>
<li style="margin:0px;padding:0px;">ip、mount 等 Linux 指令是否存在？</li>
<li style="margin:0px;padding:0px;">Docker 是否已经安装？</li>
<li style="margin:0px;padding:0px;">……</li>
</ul>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">在通过了 Preflight Checks 之后，kubeadm 要为你做的，是生成 Kubernetes 对外提供服务所需的各种证书和对应的目录。</strong></p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">Kubernetes 对外提供服务时，除非专门开启“不安全模式”，否则都要通过 HTTPS 才能访问 kube-apiserver。这就需要为 Kubernetes 集群配置好证书文件。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">kubeadm 为 Kubernetes 项目生成的证书文件都放在 Master 节点的 /etc/kubernetes/pki 目录下。在这个目录下，最主要的证书文件是 ca.crt 和对应的私钥 ca.key。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">此外，用户使用 kubectl 获取容器日志等 streaming 操作时，需要通过 kube-apiserver 向 kubelet 发起请求，这个连接也必须是安全的。kubeadm 为这一步生成的是 apiserver-kubelet-client.crt 文件，对应的私钥是 apiserver-kubelet-client.key。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">除此之外，Kubernetes 集群中还有 Aggregate APIServer 等特性，也需要用到专门的证书，这里我就不再一一列举了。需要指出的是，你可以选择不让 kubeadm 为你生成这些证书，而是拷贝现有的证书到如下证书的目录里：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>/etc/kubernetes/pki/ca.{crt,key}</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这时，kubeadm 就会跳过证书生成的步骤，把它完全交给用户处理。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">证书生成后，kubeadm 接下来会为其他组件生成访问 kube-apiserver 所需的配置文件</strong>。这些文件的路径是：/etc/kubernetes/xxx.conf：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>ls /etc/kubernetes/</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>admin.conf  controller-manager.conf  kubelet.conf  scheduler.conf</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这些文件里面记录的是，当前这个 Master 节点的服务器地址、监听端口、证书目录等信息。这样，对应的客户端（比如 scheduler，kubelet 等），可以直接加载相应的文件，使用里面的信息与 kube-apiserver 建立安全连接。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">接下来，kubeadm 会为 Master 组件生成 Pod 配置文件</strong>。我已经在上一篇文章中和你介绍过 Kubernetes 有三个 Master 组件 kube-apiserver、kube-controller-manager、kube-scheduler，而它们都会被使用 Pod 的方式部署起来。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">你可能会有些疑问：这时，Kubernetes 集群尚不存在，难道 kubeadm 会直接执行 docker run 来启动这些容器吗？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">当然不是。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在 Kubernetes 中，有一种特殊的容器启动方法叫做“Static Pod”。它允许你把要部署的 Pod 的 YAML 文件放在一个指定的目录里。这样，当这台机器上的 kubelet 启动时，它会自动检查这个目录，加载所有的 Pod YAML 文件，然后在这台机器上启动它们。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">从这一点也可以看出，kubelet 在 Kubernetes 项目中的地位非常高，在设计上它就是一个完全独立的组件，而其他 Master 组件，则更像是辅助性的系统容器。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在 kubeadm 中，Master 组件的 YAML 文件会被生成在 /etc/kubernetes/manifests 路径下。比如，kube-apiserver.yaml：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>apiVersion: v1</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>kind: Pod</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">3</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>metadata:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">4</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  annotations:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">5</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    scheduler.alpha.kubernetes.io/critical-pod: &quot;&quot;</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">6</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  creationTimestamp: null</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">7</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  labels:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">8</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    component: kube-apiserver</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">9</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    tier: control-plane</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">10</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  name: kube-apiserver</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">11</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  namespace: kube-system</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">12</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>spec:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">13</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  containers:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">14</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  - command:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">15</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - kube-apiserver</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">16</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - --authorization-mode=Node,RBAC</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">17</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - --runtime-config=api/all=true</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">18</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - --advertise-address=10.168.0.2</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">19</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    ...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">20</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - --tls-cert-file=/etc/kubernetes/pki/apiserver.crt</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">21</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - --tls-private-key-file=/etc/kubernetes/pki/apiserver.key</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">22</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    image: k8s.gcr.io/kube-apiserver-amd64:v1.11.1</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">23</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    imagePullPolicy: IfNotPresent</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">24</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    livenessProbe:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">25</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      ...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">26</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    name: kube-apiserver</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">27</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    resources:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">28</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      requests:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">29</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>        cpu: 250m</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">30</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    volumeMounts:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">31</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    - mountPath: /usr/share/ca-certificates</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">32</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      name: usr-share-ca-certificates</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">33</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      readOnly: true</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">34</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    ...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">35</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  hostNetwork: true</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">36</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  priorityClassName: system-cluster-critical</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">37</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  volumes:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">38</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  - hostPath:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">39</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      path: /etc/ca-certificates</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">40</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>      type: DirectoryOrCreate</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">41</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    name: etc-ca-certificates</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">42</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  ...</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">关于一个 Pod 的 YAML 文件怎么写、里面的字段如何解读，我会在后续专门的文章中为你详细分析。在这里，你只需要关注这样几个信息：</p>
<ol style="margin:0px;padding:0px;list-style:decimal;margin-bottom:1rem;margin-left:1.9em;">
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个 Pod 里只定义了一个容器，它使用的镜像是：<code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Courier,Courier New,monospace;">k8s.gcr.io/kube-apiserver-amd64:v1.11.1</code> 。这个镜像是 Kubernetes 官方维护的一个组件镜像。</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个容器的启动命令（commands）是 kube-apiserver --authorization-mode=Node,RBAC …，这样一句非常长的命令。其实，它就是容器里 kube-apiserver 这个二进制文件再加上指定的配置参数而已。</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">如果你要修改一个已有集群的 kube-apiserver 的配置，需要修改这个 YAML 文件。</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这些组件的参数也可以在部署时指定，我很快就会讲解到。</p>
</li>
</ol>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在这一步完成后，kubeadm 还会再生成一个 Etcd 的 Pod YAML 文件，用来通过同样的 Static Pod 的方式启动 Etcd。所以，最后 Master 组件的 Pod YAML 文件如下所示：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>$ ls /etc/kubernetes/manifests/</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>etcd.yaml  kube-apiserver.yaml  kube-controller-manager.yaml  kube-scheduler.yaml</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而一旦这些 YAML 文件出现在被 kubelet 监视的 /etc/kubernetes/manifests 目录下，kubelet 就会自动创建这些 YAML 文件中定义的 Pod，即 Master 组件的容器。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">Master 容器启动后，kubeadm 会通过检查 localhost:6443/healthz 这个 Master 组件的健康检查 URL，等待 Master 组件完全运行起来。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">然后，kubeadm 就会为集群生成一个 bootstrap token</strong>。在后面，只要持有这个 token，任何一个安装了 kubelet 和 kubadm 的节点，都可以通过 kubeadm join 加入到这个集群当中。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个 token 的值和使用方法会，会在 kubeadm init 结束后被打印出来。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">在 token 生成之后，kubeadm 会将 ca.crt 等 Master 节点的重要信息，通过 ConfigMap 的方式保存在 Etcd 当中，供后续部署 Node 节点使用</strong>。这个 ConfigMap 的名字是 cluster-info。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><strong style="color:rgb(0, 0, 0);font-weight:500;">kubeadm init 的最后一步，就是安装默认插件</strong>。Kubernetes 默认 kube-proxy 和 DNS 这两个插件是必须安装的。它们分别用来提供整个集群的服务发现和 DNS 功能。其实，这两个插件也只是两个容器镜像而已，所以 kubeadm 只要用 Kubernetes 客户端创建两个 Pod 就可以了。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">kubeadm join 的工作流程</h2>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这个流程其实非常简单，kubeadm init 生成 bootstrap token 之后，你就可以在任意一台安装了 kubelet 和 kubeadm 的机器上执行 kubeadm join 了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">可是，为什么执行 kubeadm join 需要这样一个 token 呢？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">因为，任何一台机器想要成为 Kubernetes 集群中的一个节点，就必须在集群的 kube-apiserver 上注册。可是，要想跟 apiserver 打交道，这台机器就必须要获取到相应的证书文件（CA 文件）。可是，为了能够一键安装，我们就不能让用户去 Master 节点上手动拷贝这些文件。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以，kubeadm 至少需要发起一次“不安全模式”的访问到 kube-apiserver，从而拿到保存在 ConfigMap 中的 cluster-info（它保存了 APIServer 的授权信息）。而 bootstrap token，扮演的就是这个过程中的安全验证的角色。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">只要有了 cluster-info 里的 kube-apiserver 的地址、端口、证书，kubelet 就可以以“安全模式”连接到 apiserver 上，这样一个新的节点就部署完成了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">接下来，你只要在其他节点上重复这个指令就可以了。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">配置 kubeadm 的部署参数</h2>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">我在前面讲解了 kubeadm 部署 Kubernetes 集群最关键的两个步骤，kubeadm init 和 kubeadm join。相信你一定会有这样的疑问：kubeadm 确实简单易用，可是我又该如何定制我的集群组件参数呢？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">比如，我要指定 kube-apiserver 的启动参数，该怎么办？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在这里，我强烈推荐你在使用 kubeadm init 部署 Master 节点时，使用下面这条指令：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>$ kubeadm init --config kubeadm.yaml</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">这时，你就可以给 kubeadm 提供一个 YAML 文件（比如，kubeadm.yaml），它的内容如下所示（我仅列举了主要部分）：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>apiVersion: kubeadm.k8s.io/v1alpha2</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>kind: MasterConfiguration</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">3</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>kubernetesVersion: v1.11.0</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">4</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>api:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">5</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  advertiseAddress: 192.168.0.102</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">6</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  bindPort: 6443</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">7</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  ...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">8</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>etcd:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">9</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  local:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">10</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    dataDir: /var/lib/etcd</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">11</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    image: &quot;&quot;</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">12</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>imageRepository: k8s.gcr.io</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">13</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>kubeProxy:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">14</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  config:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">15</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    bindAddress: 0.0.0.0</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">16</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    ...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">17</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>kubeletConfiguration:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">18</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  baseConfig:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">19</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    address: 0.0.0.0</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">20</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>    ...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">21</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>networking:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">22</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  dnsDomain: cluster.local</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">23</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  podSubnet: &quot;&quot;</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">24</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  serviceSubnet: 10.96.0.0/12</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">25</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>nodeRegistration:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">26</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  criSocket: /var/run/dockershim.sock</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">27</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  ...</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">通过制定这样一个部署参数配置文件，你就可以很方便地在这个文件里填写各种自定义的部署参数了。比如，我现在要指定 kube-apiserver 的参数，那么我只要在这个文件里加上这样一段信息：</p>
<pre style="margin:0px;padding:1em 1.5em;font-family:Courier,Courier New,monospace;background:hsla(0, 0%, 97%, 0.7);border:1px solid rgb(221, 221, 221);border-image:none;display:block;margin-bottom:1rem;overflow:hidden;padding-right:0px;padding-left:0px;margin-top:1rem;position:relative;"><code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;width:100%;padding-right:1rem;padding-left:1rem;font-size:0.8rem;display:block;overflow-x:auto;box-sizing:border-box;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;margin-bottom:0px;box-sizing:border-box;"><tbody style="box-sizing:border-box;"><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">1</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>...</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">2</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>apiServerExtraArgs:</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">3</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  advertise-address: 192.168.0.103</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">4</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  anonymous-auth: false</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">5</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  enable-admission-plugins: AlwaysPullImages,DefaultStorageClass</div></td></tr><tr style="box-sizing:border-box;"><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgba(27, 31, 35, 0.3);box-sizing:border-box;text-align:right;white-space:nowrap;cursor:pointer;min-width:15px;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;"><div><span style="">6</span></div></td><td style="margin:0px;padding:0px;border:0px;border-image:none;color:rgb(36, 41, 46);box-sizing:border-box;line-height:20px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;vertical-align:top;overflow:visible;padding-right:10px;padding-left:10px;white-space:pre;position:relative;word-wrap:normal;"><div>  audit-log-path: /home/johndoe/audit.log</div></td></tr></tbody></table></code><div style="top:0.2em;right:1em;color:rgb(136, 136, 136);font-size:13px;position:absolute;cursor:pointer;-ms-user-select:none;"><span style="font-size:12px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;margin-right:0.2em;"></span>复制代码</div></pre>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">然后，kubeadm 就会使用上面这些信息替换 /etc/kubernetes/manifests/kube-apiserver.yaml 里的 command 字段里的参数了。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而这个 YAML 文件提供的可配置项远不止这些。比如，你还可以修改 kubelet 和 kube-proxy 的配置，修改 Kubernetes 使用的基础镜像的 URL（默认的<code style="margin:0px;padding:0px;font-style:normal;font-weight:400;font-family:Courier,Courier New,monospace;">k8s.gcr.io/xxx</code>镜像 URL 在国内访问是有困难的），指定自己的证书文件，指定特殊的容器运行时等等。这些配置项，就留给你在后续实践中探索了。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">总结</h2>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在今天的这次分享中，我重点介绍了 kubeadm 这个部署工具的工作原理和使用方法。紧接着，我会在下一篇文章中，使用它一步步地部署一个完整的 Kubernetes 集群。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">从今天的分享中，你可以看到，kubeadm 的设计非常简洁。并且，它在实现每一步部署功能时，都在最大程度地重用 Kubernetes 已有的功能，这也就使得我们在使用 kubeadm 部署 Kubernetes 项目时，非常有“原生”的感觉，一点都不会感到突兀。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">而 kubeadm 的源代码，直接就在 kubernetes/cmd/kubeadm 目录下，是 Kubernetes 项目的一部分。其中，app/phases 文件夹下的代码，对应的就是我在这篇文章中详细介绍的每一个具体步骤。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">看到这里，你可能会猜想，kubeadm 的作者一定是 Google 公司的某个“大神”吧。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">实际上，kubeadm 几乎完全是一位高中生的作品。他叫 Lucas Käldström，芬兰人，今年只有 18 岁。kubeadm，是他 17 岁时用业余时间完成的一个社区项目。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">所以说，开源社区的魅力也在于此：一个成功的开源项目，总能够吸引到全世界最厉害的贡献者参与其中。尽管参与者的总体水平参差不齐，而且频繁的开源活动又显得杂乱无章难以管控，但一个有足够热度的社区最终的收敛方向，却一定是代码越来越完善、Bug 越来越少、功能越来越强大。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">最后，我再来回答一下我在今天这次分享开始提到的问题：kubeadm 能够用于生产环境吗？</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">到目前为止（2018 年 9 月），这个问题的答案是：不能。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">因为 kubeadm 目前最欠缺的是，一键部署一个高可用的 Kubernetes 集群，即：Etcd、Master 组件都应该是多节点集群，而不是现在这样的单点。这，当然也正是 kubeadm 接下来发展的主要方向。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">另一方面，Lucas 也正在积极地把 kubeadm phases 开放给用户，即：用户可以更加自由地定制 kubeadm 的每一个部署步骤。这些举措，都可以让这个项目更加完善，我对它的发展走向也充满了信心。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">当然，如果你有部署规模化生产环境的需求，我推荐使用<a href="https://github.com/kubernetes/kops" style="color:rgb(26, 188, 156);border-bottom-color:rgb(26, 188, 156);border-bottom-width:1px;border-bottom-style:solid;text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);">kops</a>或者 SaltStack 这样更复杂的部署工具。但，在本专栏接下来的讲解中，我都会以 kubeadm 为依据进行讲述。</p>
<ul style="margin:0px;padding:0px;list-style:disc;margin-bottom:1rem;margin-left:1.3em;">
<li style="margin:0px;padding:0px;">一方面，作为 Kubernetes 项目的原生部署工具，kubeadm 对 Kubernetes 项目特性的使用和集成，确实要比其他项目“技高一筹”，非常值得我们学习和借鉴；</li>
<li style="margin:0px;padding:0px;">另一方面，kubeadm 的部署方法，不会涉及到太多的运维工作，也不需要我们额外学习复杂的部署工具。而它部署的 Kubernetes 集群，跟一个完全使用二进制文件搭建起来的集群几乎没有任何区别。</li>
</ul>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">因此，使用 kubeadm 去部署一个 Kubernetes 集群，对于你理解 Kubernetes 组件的工作方式和架构，最好不过了。</p>
<h2 style="margin:0px;padding:0px;color:rgb(0, 0, 0);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;margin-top:1.2em;margin-bottom:0.45rem;font-size:1.12rem;font-weight:500;">思考题</h2>
<ol style="margin:0px;padding:0px;list-style:decimal;margin-bottom:1rem;margin-left:1.9em;">
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">在 Linux 上为一个类似 kube-apiserver 的 Web Server 制作证书，你知道可以用哪些工具实现吗？</p>
</li>
<li style="margin:0px;padding:0px;">
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">回忆一下我在前面文章中分享的 Kubernetes 架构，你能够说出 Kubernetes 各个功能组件之间（包含 Etcd），都有哪些建立连接或者调用的方式吗？（比如：HTTP/HTTPS，远程调用等等）</p>
</li>
</ol>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;">感谢你的收听，欢迎你给我留言，也欢迎分享给更多的朋友一起阅读。</p>
<p style="margin:0px;padding:0px;margin-bottom:1rem;color:rgb(53, 53, 53);font-weight:400;margin-top:0.15rem;"><img src="10  Kubernetes一键部署利器：kubeadm_files/47a6f3bf6b92d58512d5a2ed0a556f55.jpg" type="image/jpeg" data-filename="47a6f3bf6b92d58512d5a2ed0a556f55.jpg" alt="" height="344" style="border:0px;border-image:none;max-width:100%;display:block;background-color:rgb(238, 238, 238);" width="696"/></p>
</div></div> <p style="margin:0px;padding:0px;margin-bottom:30px;color:rgb(153, 153, 153);font-weight:400;margin-top:0.15rem;">
          版权归极客邦科技所有，未经许可不得转载
        </p></div> <div style="overflow:hidden;margin-bottom:-30px;"><a style="color:rgb(255, 255, 255);text-decoration:none;height:20px;text-align:center;line-height:20px;font-size:12px;display:inline-block;flex-grow:1;border-radius:3px;background-color:rgb(255, 90, 5);word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-box-flex:1;padding:4px 8px;cursor:pointer;float:right;">写留言</a></div> <div style="margin-top:2rem;"><h2 style="margin:0px;padding:0px;color:rgb(136, 136, 136);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;text-align:center;margin-bottom:1rem;position:relative;z-index:1;"><span style="color:rgb(136, 136, 136);line-height:1.35;font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;text-align:center;left:0px;top:56%;width:100%;border-top-color:rgb(136, 136, 136);border-top-width:1px;border-top-style:dotted;position:absolute;z-index:-1;"></span><span style="background:rgb(255, 255, 255);padding:0px 1rem;font-size:15.25px;font-weight:400;display:inline-block;">精选留言</span></h2> <ul style="margin:0px;padding:0px;list-style:none;"><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/0c06dbde.jpg" type="image/jpeg" data-filename="0c06dbde.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Antergone</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">25</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">有一个ansible playbook可以推荐给大家。<br/>https://github.com/gjmzj/kubeasz<br/>初学者可以跟着一步步看原理，后期还可以自己定制化。主要是容易产生兴趣。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/59d429c9.jpg" type="image/jpeg" data-filename="59d429c9.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">MiracleWong</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">6</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">我也补充一个可用于部署生产级别的Kubernetes的开源项目：https://github.com/kubernetes-incubator/kubespray   我们公司正在使用。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-16</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/8e6fe04d.jpg" type="image/jpeg" data-filename="8e6fe04d.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">yandd</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">推荐个k8s实验平台 https://console.magicsandbox.com，可能需要fan qiang才能访问</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-15</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/defaultAvatar.e4ab9fe.jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">包治结巴</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">张老师，后面能讲讲怎么用二进制部署kubernetes吗？毕竟kubeadm不适用于生产环境，用二进制部署还是挺复杂的，恳请老师不吝讲解一下吧。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">我不建议直接使用二进制文件部署。而建议你花时间了解一下kubeadm的高可用部署，它现在已经初具雏形了。宝贵的时间应该用在刀刃上。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-14</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/5a7247eb.jpg" type="image/jpeg" data-filename="5a7247eb.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">eden</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">一周更新三章，有点迫不及待了。不过讲得确实不错，期待后面更精彩的内容。想请教一个问题，你怎么看待openstack和k8s的关系，哪个技术门槛更高，为什么现在公司更倾向于用k8s来实现自己的云，而openstack有被k8s取代的趋势。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">当然是openstack门槛更高。90%用户要的是paas。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-14</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/132.png" type="image/png" data-filename="132.png" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Geek_700d17</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">5</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">第一时间阅读更新，有种追剧的感觉！！！</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/defaultAvatar.e4ab9fe [1].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">宝仔</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">4</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">etcd可以先部署，然后初始化的时候通过kubeadm.yaml指定已经部署好的etcd。高可用可以通过部署三个master节点来解决！现在有个问题，通过kubeadm部署生成的apiserver证书默认有效期是一年，官方是认为需要通过kubeadm upgrade 每年升级一次kubernetes，升级的时候也会更新证书，请问老师这个有解决方法吗？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-15</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">HA的etcd也是可以用kubeadm部署的，当然，external etcd有助于你自己做运维。你可以直接改证书生成的步骤，但我当然推荐你执行upgrade，这个操作是必须的。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-16</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/ce900ac6.jpg" type="image/jpeg" data-filename="ce900ac6.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">张应罗</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">其实国内同学们用kubeadm安装集群最大的拦路虎在于有几个镜像没法下载，我建议大家先手动把镜像pull 下来，从阿里的镜像源上，然后tag成安装所需的镜像名称，这样你发现安装过程会异常顺利</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-21</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">没错。kubeadm拉取镜像的url是可配置的。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-21</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/e8519ff4.jpg" type="image/jpeg" data-filename="e8519ff4.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">darling</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">fabric8 不是Java API 操作K8s吗？ 大神不知道？？？？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">Java只有大学交作业的时候用过……</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-14</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/132.jpg" type="image/jpeg" data-filename="132.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">广兴</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">kubeadm不是也支持高可用集群搭建的吗</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">这个特性还没有完全release ，也就是GA</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-14</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/5a7247eb [1].jpg" type="image/jpeg" data-filename="5a7247eb.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">eden</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">有个开源项目kubespray，支持k8s高可用部署，利用ansible来实现，这个项目部署的集群可以用于生产吧</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/defaultAvatar.e4ab9fe [2].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">pytimer</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">Kubernetes文档上现在有关于使用kubeadm部署高可用集群的说明，是不是说明可以使用kubeadm结合saltstack、ansible进行生产上的部署？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">是的，kubeadm的高可用部署应该很快就能发布了。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-14</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/defaultAvatar.e4ab9fe [3].jpg" type="image/jpeg" data-filename="defaultAvatar.e4ab9fe.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">pytimer</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">2</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">制作证书的工具: cfssl openssl easyrsa</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">赞。而是这些工具的共同点就是，难用，不够傻瓜……</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-14</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/ce7f7d54.jpg" type="image/jpeg" data-filename="ce7f7d54.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">asdf100</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">admin.conf 这个证书配置文件 是不是etcd 连接api server 时使用？</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-29</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/0.jpg" type="image/jpeg" data-filename="0.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">alex</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">对墙经验丰富的人来了，可以用下面这个镜像<br/>https://github.com/anjia0532/gcr.io_mirror</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-26</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">你好，楼道门开一下。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-27</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/bde525b1.jpg" type="image/jpeg" data-filename="bde525b1.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">北卡</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">kubeadm可以搭建高可用集群，实际上我们现在的生产环境就是使用kubeadm搭建的。<br/>只是kubeadm搭建高可用集群如果完全按照官方文档来，它生成的的证书只有一年期限。所以需要自己提前做好证书。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-23</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">需要注意高可用部署还没有GA，有很多问题亟待解决。证书在升级的时候会更新的。</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-23</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/132 [1].jpg" type="image/jpeg" data-filename="132.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">Jeff.W</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">试用Rancher搭建过一个环境，感觉过程和kubeadm有些类似，主节点初始化生成token，其它节点通过token来进行join，而且是图形化。对于部署、运维能力都有限的中小企业来说，是否可以考虑这些非原生的部署方案？甚至是否可以考虑docker swarm呢？麻烦给个建议。</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-16</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">rancher现在就是kubernetes 啊，而docker swarm就不必尝试了，人家docker公司自己都放弃了</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-16</p></div></div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/85090f41.jpg" type="image/jpeg" data-filename="85090f41.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">☆ 微~光 ☆</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">最近一直在努力学习k8s，通过自己提前的学习加上老师现在的课程，感觉自己理解的越来越深刻了，很期能够快速更新后面的课程内容！</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-16</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/89aae33a.jpg" type="image/jpeg" data-filename="89aae33a.jpg" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">志远</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">kubernetes 原来是一个芬兰的高中生写的，不禁让我想起祖师爷 linus 也是芬兰人，哎~</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-15</span> </div></li><li style="margin:0px;padding:0px;width:100%;margin-bottom:1rem;display:flex;list-style-position:inside;flex-direction:row;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><img src="10  Kubernetes一键部署利器：kubeadm_files/7705d4ba.jpg.gif" type="image/gif" data-filename="7705d4ba.jpg.gif" height="42" style="border:0px;border-image:none;border-radius:50%;width:2.62rem;height:2.62rem;flex-shrink:0;" width="42"/> <div style="margin-left:0.5rem;flex-grow:1;-webkit-box-flex:1;"><div style="width:100%;display:flex;flex-direction:row;justify-content:space-between;align-items:center;-webkit-box-align:center;-webkit-box-pack:justify;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><span style="color:rgb(136, 136, 136);line-height:1.2;font-size:15.25px;font-weight:400;">dragon</span> <div style="display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"> <a href="#" style="color:rgb(26, 188, 156);text-decoration:none;word-wrap:break-word;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);border-bottom-color:currentColor;border-bottom-width:medium;border-bottom-style:none;font-size:15.25px;display:flex;flex-direction:row;align-items:center;-webkit-box-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;"><i style="font-size:0.75rem;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(136, 136, 136);margin-top:-0.01rem;margin-right:0.3rem;display:inline-block;"></i> <span style="color:rgb(255, 90, 5);">1</span></a></div></div> <div style="color:rgb(53, 53, 53);line-height:1.6;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">Kubernetes 集群中的Aggregate APIServer 等特性，也需要用到专门的证书吗？还是直接拷贝kube-apiserver带证书就可以？通用吗。 证书这块有点不太懂</div> <span style="color:rgb(136, 136, 136);line-height:1;font-size:9px;">2018-09-14</span> <div><div style="font-size:15.25px;"><i style="font-size:15.25px;font-style:normal;-webkit-text-stroke-width:0.2px;font-family:iconfont;color:rgb(255, 90, 5);"></i> <span style="color:rgb(136, 136, 136);font-weight:400;margin-left:-12px;">作者回复</span></div> <p style="margin:0px;padding:0px;color:rgb(53, 53, 53);font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;">专门的证书, kubeadm会为你生成，自己手动做也可以</p> <p style="margin:0px;padding:0px;color:rgb(136, 136, 136);font-size:9px;">2018-09-16</p></div></div></li></ul></div></div></div></div></div></div></div><br/></div></span>
</div></body></html> 